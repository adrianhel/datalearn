## 6.2.5 Установка ClickHouse

### [Назад к ClickHouse ⤶](/data/Module6/data/clickhouse.md)

В **ClickHouse** существует множество движков таблиц, которые можно классифицировать по следующим признакам:
- По способу хранения: **постоянные** и **временные** таблицы.  
- По назначению: **основные** (для хранения пользовательских данных), **вспомогательные** (для интеграции, агрегации, 
буферизации и т.п.).  
- По поддерживаемым операциям: **модифицируемые** (поддерживают `INSERT`, `UPDATE`, `DELETE`), **только для чтения** 
(например, `VIEW`, `EXTERNAL`).  

## Основные типы таблиц
### 1. MergeTree
**MergeTree** — основной и наиболее гибкий механизм хранения, обеспечивающий:  
- _Высокую скорость вставки данных._  
- _Поддержку партиционирования (разделение данных на независимые части по указанному ключу)._   
- _Поддержку сортировки по ключу (primary key)._  
- _Вторичные индексы (skipping indices)._  
- _Фоновую агрегацию и очистку данных._  

#### Производные движки  
- **ReplacingMergeTree** — хранит только одну актуальную версию строки по ключу замены.  
- **SummingMergeTree** — осуществляет агрегацию (суммирование) по выбранным колонкам при слиянии данных.  
- **AggregatingMergeTree** — поддерживает хранение агрегированных данных с пользовательскими агрегационными функциями.  
- **CollapsingMergeTree** — поддерживает логику хранения событий с парой флагов (например, для учета отмен).  
- **VersionedCollapsingMergeTree** — вариант **CollapsingMergeTree** с поддержкой версионности строк.  
- **GraphiteMergeTree** — специализирован для хранения временных рядов графит-данных.  

#### Пример создания таблицы MergeTree

```sql
CREATE TABLE visits
(
    UserID UInt64,
    VisitDate Date,
    Page String
)
ENGINE = MergeTree
PARTITION BY toYYYYMM(VisitDate)
ORDER BY (UserID, VisitDate);
```

### 2. Log и TinyLog
**Log** — простой движок, данные хранятся в порядке вставки, индексация отсутствует. Подходит для небольших объёмов 
данных или временных таблиц.  

**TinyLog** — аналогичен **Log**, но данные хранятся в одном файле на каждый столбец, что уменьшает количество файлов, 
но снижает производительность при большом количестве данных.  

#### Пример создания таблицы Log

```sql
CREATE TABLE simple_log
(
    EventID UInt32,
    EventTime DateTime
)
ENGINE = Log;
```

### 3. StripeLog
Движок, сочетающий черты **Log** и **MergeTree**, оптимизирован для пакетной вставки строк. Каждый пакет хранится 
в виде полосы _(stripe)_.  

#### Пример создания таблицы StripeLog

```sql
CREATE TABLE stripe_log_example
(
    id UInt32,
    value String
)
ENGINE = StripeLog;
```

### 4. Memory
Данные хранятся только в оперативной памяти, что обеспечивает максимальную скорость операций, однако при перезапуске 
**ClickHouse** данные теряются. Используется для временных или промежуточных таблиц.  

#### Пример создания таблицы Memory

```sql
CREATE TABLE memory_table
(
    id UInt32,
    value String
)
ENGINE = Memory;
```

### 5. Null
Движок-пустышка, при вставке данных в такую таблицу они игнорируются, а при запросе результат всегда пустой. 
Используется для тестирования и отладки.  

#### Пример создания таблицы Null

```sql
CREATE TABLE null_table
(
    id UInt32
)
ENGINE = Null;
```
