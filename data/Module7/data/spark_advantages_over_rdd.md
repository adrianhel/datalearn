## 7.6.1 Преимущества DataFrame перед RDD

### [Назад в Модуль 7 ⤶](/data/Module7/readme.md)

### 1. Оптимизации на уровне выполнения
- **Оптимизирующий планировщик запросов (Catalyst Optimizer):**  
    - DataFrame использует Catalyst Optimizer, который анализирует, оптимизирует и перестраивает логический план 
    выполнения запроса. Это позволяет уменьшить количество операций и повысить эффективность вычислений.  
    - Пример: перестановка и объединение фильтров, выбор необходимых столбцов до выполнения операций над данными.  
- **Физические оптимизации (Tungsten):**  
    - DataFrame использует проект Tungsten для эффективного использования памяти, сериализации и управления ресурсами 
    на низком уровне, что обеспечивает более высокую производительность по сравнению с RDD.  
- **Пушдаун вычислений:**  
    - В случае интеграции со сторонними источниками данных (например, базы данных), DataFrame может "проталкивать" 
    - вычисления (фильтрацию, агрегации) ближе к источнику данных, сокращая объем передаваемых данных.  

### 2. Уровень абстракции и декларативный API
- **Декларативность:**  
    - DataFrame предоставляет декларативный API, позволяющий описывать вычисления на высоком уровне, 
    подобно SQL-запросам. Это облегчает анализ, оптимизацию и поддержку кода.  
    - Пример:  

    ```python
    # DataFrame API
    df.filter(df["age"] > 18).groupBy("country").count()
    ```

    - В то время как RDD использует императивный, функциональный стиль:  

    ```python
    # RDD API
    rdd.filter(lambda row: row.age > 18).map(lambda row: (row.country, 1)).reduceByKey(lambda x, y: x + y)
    ```

- **Выражаемость и лаконичность:**  
    - DataFrame предоставляет широкий набор встроенных функций (агрегации, фильтрации, сортировки, объединения и др.), 
    что позволяет писать более компактный и читаемый код.  

### 3. Производительность и эффективное управление ресурсами
- **DataFrame позволяет реализовать целый ряд оптимизаций, невозможных при использовании RDD:**  
    - Проект Tungsten ускоряет сериализацию, минимизирует количество аллокаций памяти.  
    - Выполнение операций векторизовано, что увеличивает скорость обработки по сравнению с построчной обработкой в RDD.    
    - DataFrame позволяет выполнять операции "на лету" (lazy evaluation) и минимизировать количество проходов по данным.  

### 4. Управление схемой и типами данных
- **Поддержка схемы:**  
    - DataFrame поддерживает явную схему (структуру столбцов и их типов), что позволяет проводить проверки типов данных 
    на этапе компиляции или рантайма.  
    - Обеспечивает интеграцию с различными источниками данных (Parquet, Avro, ORC, базы данных), где схема важна 
    для оптимизации чтения и записи.  
- **Автоматическая сериализация:**  
    - DataFrame использует внутренние механизмы сериализации, что позволяет работать с объемными наборами данных 
    более эффективно, чем с объектами пользовательских классов в RDD.  

### 5. Поддержка различных языков и интеграция с SQL
- **SQL-интерфейс:**  
    - DataFrame интегрируется с SQL-запросами, что облегчает миграцию традиционных аналитических задач в распределенную 
    среду.  

- **Возможность выполнять запросы с помощью SQL:**  

    ```python
    df.createOrReplaceTempView("people")
    spark.sql("SELECT country, COUNT(*) FROM people WHERE age > 18 GROUP BY country")
    ```
                  
- **Мульти-языковая поддержка:**  
    - DataFrame API доступен на Python, Scala, Java и R, что повышает универсальность и удобство использования.  




