## 7.6.1 Преимущества DataFrame перед RDD

### [Назад в Модуль 7 ⤶](/data/Module7/readme.md)

### 1. Оптимизации на уровне выполнения
- **Оптимизирующий планировщик запросов (Catalyst Optimizer):**  
    - DataFrame использует Catalyst Optimizer, который анализирует, оптимизирует и перестраивает логический план 
  выполнения запроса. Это позволяет уменьшить количество операций и повысить эффективность вычислений.  
    - Пример: перестановка и объединение фильтров, выбор необходимых столбцов до выполнения операций над данными.  
- **Физические оптимизации (Tungsten):**  
    - DataFrame использует проект Tungsten для эффективного использования памяти, сериализации и управления ресурсами 
  на низком уровне, что обеспечивает более высокую производительность по сравнению с RDD.  
- **Пушдаун вычислений:**  
    - В случае интеграции со сторонними источниками данных (например, базы данных), DataFrame может "проталкивать" 
    - вычисления (фильтрацию, агрегации) ближе к источнику данных, сокращая объем передаваемых данных.  

### 2. Уровень абстракции и декларативный API
- **Декларативность:**  
    - DataFrame предоставляет декларативный API, позволяющий описывать вычисления на высоком уровне, 
  подобно SQL-запросам. Это облегчает анализ, оптимизацию и поддержку кода.  
    - Пример:  

    ```python
    # DataFrame API
    df.filter(df["age"] > 18).groupBy("country").count()
    ```

    - В то время как RDD использует императивный, функциональный стиль:  

    ```python
    # RDD API
    rdd.filter(lambda row: row.age > 18).map(lambda row: (row.country, 1)).reduceByKey(lambda x, y: x + y)
    ```

- **Выражаемость и лаконичность:**  
    - DataFrame предоставляет широкий набор встроенных функций (агрегации, фильтрации, сортировки, объединения и др.), 
    что позволяет писать более компактный и читаемый код.  

