## 7.7.1 Действия (Actions) в Apache Spark

### [Назад в Модуль 7 ⤶](/data/Module7/readme.md)

- Действия инициируют выполнение вычислений, описанных преобразованиями, и возвращают результат на драйвер или записывают 
его во внешний источник.  
- Действия заставляют Spark выполнить все отложенные преобразования, необходимые для получения результата.  

## 7.7.2 Типы действий
- **collect():** Возвращает все элементы RDD или DataFrame в виде списка на драйвер.  
- **count():** Возвращает количество элементов в RDD или DataFrame.  
- **first():** Возвращает первый элемент RDD или DataFrame.  
- **take(n):** Возвращает первые n элементов RDD или DataFrame.  
- **reduce(func):** Агрегирует элементы с помощью функции. 
- **foreach(func):** Применяет функцию к каждому элементу (например, для сохранения в базу данных).
- **saveAsTextFile(path):** Сохраняет RDD как текстовый файл в файловой системе.  

```python
# Применение действия collect для выполнения вычислений и получения результата
result = squared_rdd.collect()
print(result)  # [1, 4, 9, 16, 25]
```

## 7.7.3 Что происходит при вызове действия?
Spark:
1. Смотрит на построенный DAG.  
2. Оптимизирует его (например, объединяя map и filter в одну стадию).  
3. Разбивает план на стадии (stages) и задачи (tasks).  
4. Распределяет задачи по исполнителям (executors) в кластере.  
5. Выполняет вычисления и возвращает результат.  