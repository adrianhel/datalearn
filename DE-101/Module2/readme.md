# 2. Базы данных и SQL
#### [Назад в Data Learn ⤶](/README.md)

## 2.1 Загрузка данных в БД
После установки **PostgreSQL** и подключения к БД через **DBeaver**, приступаем к созданию таблиц и загрузке данных.
#### Создание таблиц и загрузка данных
- _Таблица [Orders](data/orders.sql)_
- _Таблица [People](data/people.sql)_
- _Таблица [Returns](data/returns.sql)_

## 2.2 SQL запросы
В соответсвии с планом отчетности пишем [SQL запросы](data/sql_querys.md) к нашей БД.

## 2.3 Модели данных
### 2.3.1 Выбор схемы для Хранилища данных

> _**Хранилище данных** (Data Warehouse, DWH)_ — система для централизованного хранения и управления большим объёмом 
> структурированных данных, собранных из различных источников, для использования их в аналитике и отчётности.

На основе имеющихся данных, построим **Хранилище данных** нашего «Superstore».
За основу архитектуры возьмем способ структурирования Ральфа Кимбалла – схему «Звезда».

#### Преимущества схемы типа «Звезда»:
- **Простота** – _легко понять и использовать._
- **Производительность** – _запросы к данным выполняются быстрее (т.к. меньше соединений между таблицами)._
- **Гибкость** – _легко добавлять новые измерения и факты без значительных изменений в существующей структуре._

Схема типа «Звезда» является основным инструментом для построения Хранилищ данных и используется в системах OLAP для анализа и отчетности.

### 2.3.2 Отрисовка схемы
Воспользуемся ресурсом [SqlDBM](https://sqldbm.com/Home/) для отрисовки модели данных нашего Superstore.
- _Концептуальная схема_

<img src="img/concept.png" width="90%">

- _Логическая схема_

<img src="img/logic.png" width="90%">

- _Физическая схема_

<img src="img/physical.png" width="90%">

### 2.3.3 Основные компоненты схемы
#### Таблица фактов
`sales_fact`
- Центральная таблица, которая содержит количественные данные (факты) – продажи, доходы и другие метрики.
- Включает ключи, связывающие её с таблицами измерений, а также числовые показатели, которые будут анализироваться.

#### Таблицы измерений
- Окружают таблицу фактов и содержат атрибуты, которые описывают факты.
- Атрибуты таблиц измерений позволяют фильтровать и агрегировать данные по различным критериям.

`geography_dim` – содержит данные о месте получения заказа.

`calendar_dim` – содержит данные о дате заказа, доставки.

`customer_dim` – содержит данные о покупателе, сегменте.

`shipping_dim` – содержит данные о типе доставки.

`product_dim` – содержит данные о категории / подкатегории товаров.

### 2.3.4 Генерация кода для создания Хранилища данных
В нашем проекте на [SqlDBM](https://sqldbm.com/Home/) сгенерируем код (DDL команды) для создания Хранилища данных, 
чтобы использовать его для переноса в облако.

- [DDL команды](data/dwh.md) для создания Хранилища данных.

## 2.4 База данных в облаке
